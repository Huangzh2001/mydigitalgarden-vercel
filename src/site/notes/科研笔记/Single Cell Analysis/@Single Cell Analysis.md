---
{"tags":["Notes","Single-Cell-Analysis","gardenEntry"],"title":"Home","dg-publish":true,"dg-home":true,"permalink":"/科研笔记/Single Cell Analysis/@Single Cell Analysis/","dgPassFrontmatter":true}
---


# 一.单细胞分析技术总览

基因表达主要有三个步骤:**染色质转录,mRNA翻译**和**表达为蛋白**.所以我们想要了解单细胞表达了什么基因也有三种相应的方式:**染色质可及性分析,转录组分析和蛋白表达分析**.

所有的测序分析都有各自的优点和局限性，必须通过数据分析了解这些优点和局限性才能意识到数据中可能存在的偏差。

下面我们将分别介绍这三项技术的基本工作流程和分析方法.

我打算采用三层级结构来讲解这里的知识:第一个层级就是单细胞分析技术的基本工作流程和用到的分析方法;第二个层级就是分析方法的原理与代码实现;第三个层级就是项目实战.这三层利用链接相互连接.我打算在前两层使用md编写,第三层采用jupyter notebook编写,

# 二.转录组分析的**基本**工作流程

## (一)获取转录组数据

### (1)DNA测序简介

首先我们先介绍一下DNA测序.所有的DNA测序技术的流程一般分为三个步骤:
1. 样品与文库制备
2. 扩增和测序
3. 数据输出和分析

对于前面两个环节,大家可以通过下面的链接了解,我们这本笔记主要专注于上述步骤的数据分析环节.

> [!tip]
> 测序技术简史
> 
> 第一代测序技术:[【陈巍学基因】视频25：第一代DNA测序_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1ws411d7U9/?spm_id_from=333.880.my_history.page.click)
> 
> 第二代测序技术:[【陈巍学基因】视频1：Illumina测序化学原理_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1oJ411r7e7/?spm_id_from=333.788&vd_source=06168f390bae49c4867767c52a20e87c)
> 
> 第三代测序技术:[【陈巍学基因】视频59：Nanopore测序_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1KJ411k7R2/?spm_id_from=333.788&vd_source=06168f390bae49c4867767c52a20e87c)

### (2)RNA测序简介

RNA测序很大程度上遵循 DNA 测序方案，只是多了逆转录步骤，即从 RNA 模板合成互补 DNA (cDNA).

RNA测序(RNA-Seq)根据研究目的的不同有两种测序方式:
* 如果想要研究多个细胞的平均表达谱,可以对感兴趣来源的跨细胞的混合RNA进行测序（也称为批量测序）
* 如果想要研究单个细胞的表达情况,可以对单个细胞的转录组进行单独测序（也称为单细胞测序(scRNA-Seq)）
在大多数情况下，混合所有细胞的 RNA 比实验上复杂的单细胞测序更便宜、更容易.

### (3)单细胞RNA测序简介

特别地,单细胞测序在原来的RNA测序方案上需要额外增加一步:分离出单个细胞,并在转录物的扩增中对其mRNA片段进行标记,以便能够稍后将获得的转录组数据对应回起源细胞.

这一个步骤的不同就产生了不同的scRNA-seq技术.

目前根据细胞分离方案的不同,我们可以把单细胞测序技术分为三类:
* 基于微流体装置的策略，其中细胞被封装到水凝胶液滴中(inDrop, Drop-seq和10x Genomics Chromium)；
* 基于孔板的方案，其中细胞被物理分离到微孔板中(SMART-seq2、MARS-seq、QUARTZ-seq 和 SRCB-seq)；
* 基于商用 Fluidigm C1 微流控芯片的解决方案，可将细胞自动装载并分离到小型反应室中.

> [!tip]
> 
> 基于微流体装置的策略:[【陈巍学基因】视频56：10X分析单细胞表达_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1PJ411k7mz/?spm_id_from=333.337.search-card.all.click&vd_source=06168f390bae49c4867767c52a20e87c)
> 

> [!summary]
> 我们首先介绍了三代DNA测序技术,及其三个步骤;
> 
> 然后我们介绍了RNA测序技术,RNA测序技术只是在DNA测序技术上多了一步"逆转录为cDNA"的步骤;
> 
> RNA测序技术分为两种,一种是批量测序,一种是单细胞测序.单细胞测序多了一个"分离出单个细胞,并对其mRNA片段进行标记"的步骤.这个步骤的不同实现方式就产生了不同的单细胞测序技术.


## (二)原始转录组数据处理

我们利用上述方法获取的转录组数据一般是 FASTQ 文件(使用的是第二代测序技术).

FASTQ 文件简介:[fastq文件解读_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1tM4y1G7Vs/?p=2&spm_id_from=333.880.my_history.page.click&vd_source=06168f390bae49c4867767c52a20e87c)

我们需要在这一步将 FASTQ 文件转化为我们后续处理用的计数矩阵:

![@Single Cell Analysis HomePage.png](/img/user/%E7%A7%91%E7%A0%94%E7%AC%94%E8%AE%B0/Single%20Cell%20Analysis/attachments/@Single%20Cell%20Analysis%20HomePage.png)

计数矩阵的行代表不同的基因,列代表不同的细胞,第(i,j)元代表第j个细胞表达第i个基因的次数.

我们在后面的转录组分析中主要处理的就是这样的计数矩阵.

由于在测量的过程中会出现各种原始数据的遗漏、减少或扭曲,而对计数矩阵的准确估计是后续准确分析的基础,所以我们在这一步对原始数据进行处理,以获得较为准确的计数矩阵是十分必要的.

原始数据处理的基本步骤，包括读取比对/映射、细胞条形码 (CB) 识别和校正，以及通过唯一分子标识符 (UMI) 的解析来估计分子计数.

```ad-tip
我们的重点将放在数据分析阶段,所以这一段先略过.我以后有时间再完善.https://www.sc-best-practices.org/introduction/raw_data_processing.html
```
## (三).转录组分析

我们的分析工具主要是基于 R 的 Bioconductor 和 Seurat 框架和基于 Python 的 [[科研笔记/Single Cell Analysis/scverse 框架\|scverse 框架]].

### 1.步骤一:数据预处理

目的:从原始计数矩阵到高质量的细胞数据.
#### (1)去除采样时产生的随机噪声.

scRNA-seq数据可能会包含系统的随机噪声,所以我们需要把这些噪声都去掉.

```ad-info
理想情况下(每个凝胶微珠中只有一个完好细胞),我们认为计数矩阵记录的是每个细胞(cell)里面的基因表达量.

但事实上,由于每个barcode对应于一个凝胶微珠,而一个凝胶微珠里面可能没有细胞,也可能有多个细胞.所以我们得到的计数矩阵其实记录的是每个条形码(barcode)里面的基因表达量,而不是每个细胞的.
```

这些噪声可能来源于:
1. 低质量细胞(比如已经死去的细胞).我们可以通过设置阈值或根据中值绝对偏差的数量来[[科研笔记/Single Cell Analysis/过滤低质量细胞\|过滤低质量细胞]];
2. 环境RNA.我们可以通过”根据数据集中其他“空”液滴和细胞簇的表达谱来估计细胞特异性污染分数”等方法来[[科研笔记/Single Cell Analysis/去除环境RNA\|去除环境RNA]]的影响;
3. 空液滴和双峰（包含两个细胞的液滴）.我们可以用多重双峰检测方法来[[科研笔记/Single Cell Analysis/检测双联体\|检测双联体]].

![@Single Cell Analysis HomePage-1.png](/img/user/%E7%A7%91%E7%A0%94%E7%AC%94%E8%AE%B0/Single%20Cell%20Analysis/attachments/@Single%20Cell%20Analysis%20HomePage-1.png)

#### (2)标准化Normalization and variance stabilization

我们将介绍三种不同的归一化技术：
* the shifted logarithm transformation(移位对数变换);
* scran normalization;
* analytic approximation of Pearson residuals(pearson残差的解析逼近)

[[科研笔记/Single Cell Analysis/Normalization and variance stabilization\|Normalization and variance stabilization]]

#### (3)消除令人困惑的变异来源

变异的来源可以分为**技术因素**和**生物因素**.

技术因素主要是”批次效应”.如果我们实验用的是来源不同的数据,旧数据可能因为技术相对落后,导致贸然将两者混合会出现问题,这就是批次效应.

生物因素,比如细胞的周期状态可能对数据产生影响.

#### (4)特征选择与降维

目的:挑选信息量大的特征并降维

主要方法有:特征选择法,主成分分析法等.

### 2.步骤二:识别不同的细胞群以进一步分析

#### (1)聚类(Clustering)

**聚类(Clustering),将细胞分为具有相似表达谱的组.**分类方法有Louvain算法, Leiden 算法等.

#### (2)标注每组细胞的身份

即通过每组细胞所具有的特征,来标定这组细胞是属于哪一类细胞.标注可以通过手动或自动方法来执行。建议采用三步法，即利用自动注释，然后是专家手​​动注释和最后一步验证，以获得理想的注释结果.

#### (3)从离散状态到连续过程

由于我们得到的是离散的一组组细胞组,但是细胞的演化是一个连续的过程,所以我们需要将这个离散的状态连续化.比如根据细胞表达模式的相似性沿着轨迹对细胞进行排序,这样的模型被称为轨迹推断或伪时间分析方法。

### 3.步骤三:研究具体问题,**揭示机制**

在获得**高质量数据**的**可靠注释**后，可以开始研究许多感兴趣的机制。以下分析步骤的选择和顺序取决于感兴趣的问题和实验设计:
#### (1)差异基因表达分析

一般分成两种:
1.  如果我们关注于某细胞类型与其他细胞类型相比的表达差异,则我们可以把这组细胞类型当作实验组,将其余所有细胞类型当作对照组,来寻找在我们感兴趣的细胞类型中特异性高表达的基因(也就是特征基因).
2.  如果我们专注于某个细胞类型在样本之间的表达差异,则我们可以选定这个细胞类型,在样本之间做差异性分析,找出在两组之间表达差异显著的基因.

#### (2)基因集富集分析

基因集富集分析是为了将基因与生物学过程相联系,一般放在差异基因表达分析之后.我们得到了差异性基因,我们还希望知道是什么生物学过程导致了差异性基因的出现.

比如我们得到了一个差异表达基因集合,我们想要知道它是不是”生长素信号转导相关”这一生物学过程引起的.同时我们已知这个物种一共有100个基因，其中20个基因与生长素信号转导相关,其余无关;差异表达基因共10个，其中2个与生长素信号转导相关，而另外8个无关.

这其实可以抽象为一个”摸球问题”.

<https://blog.csdn.net/qq_38774801/article/details/121026942>

<https://blog.csdn.net/abai0410/article/details/121856450>

#### (3)破译细胞组成的变化



#### (4)推断扰动效应



#### (5)跨细胞的通信事件



# 三.染色质可及性分析的基本工作流程


# 四.蛋白表达分析的基本工作流程



# 参考文献

1. https://www.sc-best-practices.org/preamble.html
2. https://bioconductor.org/books/release/OSCA/